<div class="col-lg-12">
  <div class="card-body">
    <button type="button" class="close pull-right" (click)="close()">
      <span aria-hidden="true">×</span>
    </button>
    <h4 class="card-title mb-4">Crée colis</h4>
    <aw-wizard [navBarLayout]="'large-empty-symbols'">
      <form [formGroup]="shippmentForm" class="form col-12">

        <aw-wizard-step>
          <ng-template awWizardStepSymbol>
            <i class="ri-number-1"></i>
          </ng-template>
          <div class="row mt-2 ">
            <div class="col-12 ">
              <p class="legend mx-auto"><span>Information du Client</span></p>

              <!-- Raison sociale -->
              <div class="form-group row mb-3 mt-4">
                <label class="col-md-3 col-form-label text-right" for="raisonSociale">Raison sociale*: </label>
                <div class="col-md-9">
                  <input class="form-control" formControlName="raisonSociale" type="text" placeholder="Raison sociale"
                    [ngClass]="{'is-invalid': shippmentForm.controls['raisonSociale'].invalid && (shippmentForm.controls['raisonSociale'].dirty || shippmentForm.controls['raisonSociale'].touched),'is-valid': shippmentForm.controls['raisonSociale'].valid && (shippmentForm.controls['raisonSociale'].dirty || shippmentForm.controls['raisonSociale'].touched) }">
                  <div *ngIf="shippmentForm.controls['raisonSociale'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['raisonSociale'].errors.minlength">longueur minimale 3
                      characters </span>
                    <span *ngIf="shippmentForm.controls['raisonSociale'].errors.maxlength">Longuer maximale 50
                      characters</span>
                  </div>
                </div>
              </div>

              <!-- Nom -->
              <div class="form-group row mb-3">
                <label class="col-md-3 col-form-label text-right" for="nom">Nom*:</label>
                <div class="col-md-9">
                  <input class="form-control" formControlName="nom" type="text" placeholder="Nom"
                    [ngClass]="{'is-invalid': shippmentForm.controls['nom'].invalid && (shippmentForm.controls['nom'].dirty || shippmentForm.controls['nom'].touched),'is-valid': shippmentForm.controls['nom'].valid && (shippmentForm.controls['nom'].dirty || shippmentForm.controls['nom'].touched) }">
                  <div *ngIf="shippmentForm.controls['nom'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['nom'].errors.required">Nom requie</span>
                    <span *ngIf="shippmentForm.controls['nom'].errors.minlength">longueur minimale 3
                      characters
                      characters or more.</span>
                    <span *ngIf="shippmentForm.controls['nom'].errors.maxlength">Longuer maximale 50
                      characters</span>
                  </div>
                </div>
              </div>

              <!-- Prenom -->
              <div class="form-group row mb-3 ">
                <label class="col-md-3 col-form-label text-right">Prénom*:</label>
                <div class="col-md-9">
                  <input class="form-control" formControlName="prenom" placeholder="Prénom"
                    [ngClass]="{'is-invalid': shippmentForm.controls['prenom'].invalid && (shippmentForm.controls['prenom'].dirty || shippmentForm.controls['prenom'].touched),'is-valid': shippmentForm.controls['prenom'].valid && (shippmentForm.controls['prenom'].dirty || shippmentForm.controls['prenom'].touched) }">
                  <div *ngIf="shippmentForm.controls['prenom'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['prenom'].errors.required">Prénom requie</span>
                    <span *ngIf="shippmentForm.controls['prenom'].errors.minlength">longueur minimale 3
                      characters</span>
                    <span *ngIf="shippmentForm.controls['prenom'].errors.maxlength">Longuer maximale 50
                      characters</span>
                  </div>
                </div>
              </div>

              <!-- Telephone -->
              <div class="form-group row mb-3 text-right">
                <label class="col-md-3 col-form-label">Téléphone*:</label>
                <div class="col-md-9 text-left">
                  <input class="form-control" formControlName="telephone" placeholder="00-00-00-00-00" type="text"
                    mask="00-00-00-00-00"
                    [ngClass]="{'is-invalid': shippmentForm.controls['telephone'].invalid && (shippmentForm.controls['telephone'].dirty || shippmentForm.controls['telephone'].touched),'is-valid': shippmentForm.controls['telephone'].valid && (shippmentForm.controls['telephone'].dirty || shippmentForm.controls['telephone'].touched) }">
                  <div *ngIf="shippmentForm.controls['telephone'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['telephone'].errors.required">Téléphone requie</span>
                    <span *ngIf="shippmentForm.controls['telephone'].errors.minlength">longueur autoriser 10
                      characters</span>
                  </div>
                </div>
              </div>

              <!-- Type de livraison-->
              <div class="col-12 p-2 mt-3">
                <div class="row">
                  <p class="legend mx-auto"><span>Type de livraison</span></p>
                </div>
                <div class="row">
                  <div class="col-6 ">
                    <div class="row">
                      <label class="col-6 col-form-label  text-right" for="livraisonStopDesck">Lvarison Stop Desck
                        :</label>
                      <div class="col-6 mt-1 ">
                        <ui-switch uncheckedLabel="Non" checkedLabel="Oui" formControlName="livraisonStopDesck"
                          (valueChange)="onChangeShippmentTypeDesk($event)">
                        </ui-switch>
                      </div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="row">
                      <label class="col-6 col-form-label  text-right" for="livraisonDomicile">livraison domicile
                        :</label>
                      <div class="col-6 mt-1 ">
                        <ui-switch uncheckedLabel="Non" checkedLabel="Oui" formControlName="livraisonDomicile"
                          (valueChange)="onChangeShippmentTypeHome($event)">
                        </ui-switch>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <ul class="list-inline wizard mt-3 mb-0">
            <li class="next list-inline-item float-right">
              <button class="btn btn-md btn-info waves-effect waves-light" [disabled]="!stepOneValide()" awNextStep>
                Suivant
                <i class="ri-arrow-right-line align-middle ms-2"></i>
              </button>
            </li>
          </ul>
        </aw-wizard-step>
        <aw-wizard-step>
          <ng-template awWizardStepSymbol>
            <i class="ri-number-2"></i>
          </ng-template>
          <div class="row">
            <div class="col-12">
              <p class="legend mx-auto"><span>Information de livraison</span></p>
              <!-- wilaya -->
              <div class="form-group row mb-3 text-right">
                <label class="col-md-3 col-form-label"> Wilaya*: </label>
                <div class="col-sm-9 text-left">
                  <ng-select formControlName="wilayaId" placeholder=" Selectionner la wilaya"
                    (change)="onChangeWilaya()">
                    <ng-option *ngFor="let wilaya of wilayasData" [value]="wilaya.id">
                      {{ wilaya.codeWilaya }} {{ wilaya.nomLatin }}
                    </ng-option>
                  </ng-select>
                  <span *ngIf="shippmentForm.controls['wilayaId'].invalid && shippmentForm.controls['wilayaId'].touched"
                    class="invalid-feedback-custom">Wilaya requise</span>
                  <span *ngIf="shippmentForm.controls['wilayaId'].valid && shippmentForm.controls['wilayaId'].touched"
                    class="valid-feedback-custom">Wilaya valide</span>
                </div>
              </div>

              <!--commune-->
              <div class="form-group row mb-3 text-right">
                <label class="col-md-3 col-form-label"> Commune*: </label>
                <div class="col-sm-9 text-left">
                  <ng-select formControlName="communeId" placeholder="Selectionner la commune">
                    <ng-option *ngFor="let commune of communesData" [value]="commune.id">
                      {{ commune.codePostal }} {{ commune.nomLatin }}
                    </ng-option>
                  </ng-select>
                  <span
                    *ngIf="shippmentForm.controls['communeId'].invalid && shippmentForm.controls['communeId'].touched"
                    class="invalid-feedback-custom">Commune requise</span>
                  <span *ngIf="shippmentForm.controls['communeId'].valid && shippmentForm.controls['communeId'].touched"
                    class="valid-feedback-custom">Commune valide</span>
                </div>
              </div>
              <!--Domicile || stop desck-->
              <div *ngIf="shippmentForm.controls['livraisonDomicile'].value" class="form-group row mb-3 text-right">
                <label class="col-md-3 col-form-label">Adresse*:</label>
                <div class="col-md-9 text-left">
                  <input class="form-control" formControlName="adresse" placeholder="Adresse"
                    [ngClass]="{'is-invalid': shippmentForm.controls['adresse'].invalid && (shippmentForm.controls['adresse'].dirty || shippmentForm.controls['adresse'].touched),'is-valid': shippmentForm.controls['adresse'].valid && (shippmentForm.controls['adresse'].dirty || shippmentForm.controls['adresse'].touched) }">
                  <div *ngIf="shippmentForm.controls['adresse'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['adresse'].errors.required">Adresse requise</span>
                    <span *ngIf="shippmentForm.controls['adresse'].errors.minlength">longueur minimale 3 characters
                    </span>
                    <span *ngIf="shippmentForm.controls['adresse'].errors.maxlength">longueur maximale 50
                      characters </span>
                  </div>
                </div>
              </div>

              <!-- Service -->
              <div class="form-group row mb-3 text-right">
                <label class="col-md-3 col-form-label"> Service*: </label>
                <div class="col-sm-9 text-left">
                  <ng-select formControlName="serviceId" placeholder="Selectionner le service">
                    <ng-option *ngFor="let service of serviceData" [value]="service.service_id">
                      {{ service.service_nom }}
                    </ng-option>
                  </ng-select>
                  <span
                    *ngIf="shippmentForm.controls['serviceId'].invalid && shippmentForm.controls['serviceId'].touched"
                    class="invalid-feedback-custom">Service requie</span>
                  <span *ngIf="shippmentForm.controls['serviceId'].valid && shippmentForm.controls['serviceId'].touched"
                    class="valid-feedback-custom">Service valide</span>
                </div>
              </div>

              <!-- N° Commande-->
              <div class="form-group row mb-3 ">
                <label class="col-md-3 col-form-label text-right">N° Commande*:</label>
                <div class="col-md-9">
                  <input class="form-control" formControlName="numCommande" placeholder="N° Commande "
                    [ngClass]="{'is-invalid': shippmentForm.controls['numCommande'].invalid && (shippmentForm.controls['numCommande'].dirty || shippmentForm.controls['numCommande'].touched),'is-valid': shippmentForm.controls['numCommande'].valid && (shippmentForm.controls['numCommande'].dirty || shippmentForm.controls['numCommande'].touched) }">
                  <div *ngIf="shippmentForm.controls['numCommande'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['numCommande'].errors.required">Numéro de commande requie</span>
                    <span *ngIf="shippmentForm.controls['numCommande'].errors.minlength">longueur minimale 3
                      characters</span>
                    <span *ngIf="shippmentForm.controls['numCommande'].errors.maxlength">longueur maximale 50
                      characters</span>
                  </div>
                </div>
              </div>

              <!-- Designation -->
              <div class="form-group row mb-3 ">
                <label class="col-md-3 col-form-label text-right">Désignations*:</label>
                <div class="col-md-9">
                  <input class="form-control" formControlName="designationProduit" placeholder="Désignation Produit "
                    [ngClass]="{'is-invalid': shippmentForm.controls['designationProduit'].invalid && (shippmentForm.controls['designationProduit'].dirty || shippmentForm.controls['designationProduit'].touched),'is-valid': shippmentForm.controls['designationProduit'].valid && (shippmentForm.controls['designationProduit'].dirty || shippmentForm.controls['designationProduit'].touched) }">
                  <div *ngIf="shippmentForm.controls['designationProduit'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['designationProduit'].errors.required">Designation produit
                      requise</span>
                    <span *ngIf="shippmentForm.controls['designationProduit'].errors.minlength">longueur minimale 3
                      characters</span>
                    <span *ngIf="shippmentForm.controls['designationProduit'].errors.maxlength">longueur maximale 50
                      characters</span>
                  </div>
                </div>
              </div>

                      <!-- Prix Produit-->
                      <div class="form-group row mb-3 ">
                        <label class="col-md-3 col-form-label text-right">Prix du produit*:</label>
                        <div class="col-md-9">
                          <div class="input-group">
                            <input type="number" class="form-control" formControlName="prixVente" placeholder="Prix de vante du Produit "
                              (keyup)="setValuePrixEstimer()"
                              [ngClass]="{'is-invalid': shippmentForm.controls['prixVente'].invalid && (shippmentForm.controls['prixVente'].dirty || shippmentForm.controls['prixVente'].touched),'is-valid': shippmentForm.controls['prixVente'].valid && (shippmentForm.controls['prixVente'].dirty || shippmentForm.controls['prixVente'].touched) }">
                            <div class="input-group-prepend">
                              <span class="input-group-text" id="validationTooltipUsernamePrepend">DA</span>
                            </div>
                            <div *ngIf="shippmentForm.controls['prixVente'].invalid" class="invalid-feedback">
                              <span *ngIf="shippmentForm.controls['prixVente'].errors.required">prix de vente requis</span>
                              <span *ngIf="shippmentForm.controls['prixVente'].errors.minlength">longueur minimale 3
                                characters.</span>
                              <span *ngIf="shippmentForm.controls['prixVente'].errors.maxlength">longueur maximale 50
                                characters.</span>
                            </div>
                          </div>
                        </div>
                      </div>
                      
                      <!-- Prix Estimer-->
                      <div class="form-group row mb-3 ">
                        <label class="col-md-3 col-form-label text-right">Prix estimé*:</label>
                        <div class="col-md-9">
                          <div class="input-group">
                            <input type="number" min="1000" class="form-control" formControlName="prixEstimer"
                              placeholder="Prix de vante du Produit "
                              [ngClass]="{'is-invalid': shippmentForm.controls['prixEstimer'].invalid && (shippmentForm.controls['prixEstimer'].dirty || shippmentForm.controls['prixEstimer'].touched),'is-valid': shippmentForm.controls['prixEstimer'].valid && (shippmentForm.controls['prixEstimer'].dirty || shippmentForm.controls['prixEstimer'].touched) }">
                            <div class="input-group-prepend">
                              <span class="input-group-text" id="validationTooltipUsernamePrepend">DA</span>
                            </div>
                            <div *ngIf="shippmentForm.controls['prixEstimer'].invalid" class="invalid-feedback">
                              <span *ngIf="shippmentForm.controls['prixEstimer'].errors.required">prix de vente requis</span>
                              <span *ngIf="shippmentForm.controls['prixEstimer'].errors.minlength">longueur minimale 3
                                characters.</span>
                              <span *ngIf="shippmentForm.controls['prixEstimer'].errors.maxlength">longueur maximale 50
                                characters.</span>
                            </div>
                          </div>
                        </div>
                      </div>



              <div class="row">
                <p class="legend mx-auto"><span>Paramétres de livraison</span></p>
              </div>
              <div class="row">

                <div class="col-6 ">
                  <!-- Livraison Gratuite-->
                  <div class="row ">
                    <label class="col-6  col-form-label text-right" for="livraisonGratuite"> Livraison
                      gratuite*:</label>
                    <div class="col-6 mt-1">
                      <ui-switch uncheckedLabel="Non" checkedLabel="Oui" formControlName="livraisonGratuite">
                      </ui-switch>
                    </div>
                  </div>

                </div>
                <div class="col-6">
                  <div class="row ">
                    <label class="col-6  col-form-label text-right" for="echange">Echange
                      *:</label>
                    <div class="col-6 mt-1">
                      <ui-switch uncheckedLabel="Non" checkedLabel="Oui" formControlName="echange"
                          (valueChange)="onChangeShippmentEchange($event)">
                      </ui-switch>
                    </div>
                  </div>
                </div>

              </div>

        <!-- Designation -->
        <div class="form-group row my-3" *ngIf="shippmentForm.controls['echange'].value">
          <label class="col-md-3 col-form-label text-right">Objet à récupérer*:</label>
          <div class="col-md-9">
            <input class="form-control" formControlName="objetRecuperer" placeholder="Objet à récupérer"
              [ngClass]="{'is-invalid': shippmentForm.controls['objetRecuperer'].invalid && (shippmentForm.controls['objetRecuperer'].dirty || shippmentForm.controls['objetRecuperer'].touched),'is-valid': shippmentForm.controls['objetRecuperer'].valid && (shippmentForm.controls['objetRecuperer'].dirty || shippmentForm.controls['objetRecuperer'].touched) }">
            <div *ngIf="shippmentForm.controls['objetRecuperer'].invalid" class="invalid-feedback">
              <span *ngIf="shippmentForm.controls['objetRecuperer'].errors.required">Objet à récupérer
                requise</span>
              <span *ngIf="shippmentForm.controls['objetRecuperer'].errors.minlength">longueur minimale 1
                characters</span>
              <span *ngIf="shippmentForm.controls['objetRecuperer'].errors.maxlength">longueur maximale 30
                characters</span>
            </div>
          </div>
        </div>



            </div>
          </div>
          <ul class="list-inline wizard mt-3 mb-0">
            <li class="previous list-inline-item"><button class="btn btn-md btn-outline-info waves-effect waves-light"
                awPreviousStep>
                <i class="ri-arrow-left-line align-middle ms-2"></i>
                Previous</button>
            </li>
            <li class="next list-inline-item float-right">
              <!-- [disabled]="!(this.shippmentForm.get('serviceId').valid && this.shippmentForm.get('numCommande').valid && this.shippmentForm.get('designationProduit').valid && this.shippmentForm.get('prixVente').valid )" -->
              <button class="btn btn-md btn-info waves-effect waves-light " awNextStep [disabled]="!stepTwoValide()">
                Suivant
                <i class="ri-arrow-right-line align-middle ms-2"></i>
              </button>
            </li>
          </ul>
        </aw-wizard-step>

        <aw-wizard-step>
          <ng-template awWizardStepSymbol>
            <i class="fas fa-check-circle"></i>
          </ng-template>
          <div class="row">
            <div class="col-12">
              <p class="legend mx-auto"><span>Poids et dimensions</span></p>

            </div>
            <div class="col-6">
              <div class="form-group row mb-3 ">
                <label class="col-md-4 col-form-label text-right">Poids (Kg)*:</label>
                <div class="col-md-7">
                  <input type="number" min="0" max="150" class="form-control" formControlName="poids"
                    placeholder="Poids (Kg)"
                    [ngClass]="{'is-invalid': shippmentForm.controls['poids'].invalid && (shippmentForm.controls['poids'].dirty || shippmentForm.controls['poids'].touched),'is-valid': shippmentForm.controls['poids'].valid && (shippmentForm.controls['poids'].dirty || shippmentForm.controls['poids'].touched) }">
                  <div *ngIf="shippmentForm.controls['poids'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['poids'].errors.required">poids
                      requie</span>
                  </div>
                </div>
              </div>
              <div class="form-group row mb-3 ">
                <label class="col-md-4 col-form-label text-right">Largeur (m):</label>
                <div class="col-md-7">
                  <input type="number" step="0.1" min="0" max="2" class="form-control" formControlName="largeur"
                    placeholder="largeur (m)"
                    [ngClass]="{'is-invalid': shippmentForm.controls['largeur'].invalid && (shippmentForm.controls['largeur'].dirty || shippmentForm.controls['largeur'].touched),'is-valid': shippmentForm.controls['largeur'].valid && (shippmentForm.controls['largeur'].dirty || shippmentForm.controls['largeur'].touched) }">
                  <div *ngIf="shippmentForm.controls['largeur'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['largeur'].errors.required">largeur
                      requie</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="form-group row mb-3 ">
                <label class="col-md-4 col-form-label text-right">longueur (m)*:</label>
                <div class="col-md-7">
                  <input type="number" step="0.1" min="0" max="2" class="form-control" formControlName="longueur"
                    placeholder="longueur (m) "
                    [ngClass]="{'is-invalid': shippmentForm.controls['longueur'].invalid && (shippmentForm.controls['longueur'].dirty || shippmentForm.controls['longueur'].touched),'is-valid': shippmentForm.controls['longueur'].valid && (shippmentForm.controls['longueur'].dirty || shippmentForm.controls['longueur'].touched) }">
                  <div *ngIf="shippmentForm.controls['longueur'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['longueur'].errors.required">longueur
                      requie</span>
                  </div>
                </div>
              </div>
              <div class="form-group row mb-3 ">
                <label class="col-md-4 col-form-label text-right">Hauteur (m)*:</label>
                <div class="col-md-7">
                  <input type="number" step="0.1" min="0" max="2" class="form-control" formControlName="hauteur"
                    placeholder="Hauteur (m) "
                    [ngClass]="{'is-invalid': shippmentForm.controls['hauteur'].invalid && (shippmentForm.controls['hauteur'].dirty || shippmentForm.controls['hauteur'].touched),'is-valid': shippmentForm.controls['hauteur'].valid && (shippmentForm.controls['hauteur'].dirty || shippmentForm.controls['hauteur'].touched) }">
                  <div *ngIf="shippmentForm.controls['hauteur'].invalid" class="invalid-feedback">
                    <span *ngIf="shippmentForm.controls['hauteur'].errors.required">hauteur
                      requie</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row mt-4">
            <div class="col-6">
              <button class="btn btn-md btn-outline-info waves-effect waves-light" awPreviousStep>
                <i class="ri-arrow-left-line align-middle ms-2"></i>
                Previous
              </button>
            </div>

            <div class="col-6 text-right ml-auto">
              <!-- [disabled]="!(this.shippmentForm.get('serviceId').valid && this.shippmentForm.get('numCommande').valid && this.shippmentForm.get('designationProduit').valid && this.shippmentForm.get('prixVente').valid )" -->
              <!-- <button class="btn btn-md btn-success waves-effect waves-light " [disabled]="!stepThreeValide()" (click)="createShipment('12456687167')"   [awGoToStep]="createShipment('12456687167')?{stepIndex: 0} : {stepIndex: 3} ">
                <i class="ri-checkbox-circle-fill align-middle me-2"></i>
                Valider et continuer
              </button> -->
              <button class="btn btn-md btn-success waves-effect waves-light mx-auto" [disabled]="!stepThreeValide()"
                (click)="createShipment()">
                <i class="ri-check-line align-middle me-2"></i>
                Valider
              </button>
            </div>
          </div>
        </aw-wizard-step>
      </form>
    </aw-wizard>
  </div>
</div>